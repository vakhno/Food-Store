{"ast":null,"code":"const initialState = {\n  items: {},\n  totalPrice: 0,\n  totalCount: 0\n};\n\nconst placeNewCategoryDish = (state, payload) => {\n  let lengthDishesTypes = Object.keys(state.items[payload.id]).length;\n  let sameTypeIndex = Object.values(state.items[payload.id]).findIndex(elem => {\n    if (payload.toggle1 && payload.toggle2) {\n      return elem[0].toggle1 === payload.toggle1 && elem[0].toggle2 === payload.toggle2;\n    } else if (payload.toggle1) {\n      return elem[0].toggle1 === payload.toggle1;\n    }\n\n    return true;\n  });\n\n  if (sameTypeIndex !== -1) {\n    payload.categoryId = +`${payload.id}.${++sameTypeIndex}`;\n    state.items[payload.id][`${payload.id}.${sameTypeIndex}`].push(payload);\n  } else {\n    payload.categoryId = +`${payload.id}.${++lengthDishesTypes}`;\n    state.items[payload.id][`${payload.id}.${lengthDishesTypes}`] = [payload];\n  }\n\n  return state.items[payload.id];\n};\n\nconst placeNewDish = payload => {\n  payload.categoryId = +payload.id + 0.1;\n  return {\n    [payload.id + 0.1]: [payload]\n  };\n};\n\nconst calculateTotalPrice = items => {\n  return Object.values(items).reduce((accum, cur) => Object.values(cur).reduce((accum, cur) => Object.values(cur).reduce((accum, cur) => cur.price + +accum, 0) + +accum, 0) + +accum, 0);\n};\n\nconst calculateTotalCount = newItems => {\n  return Object.values(newItems).reduce((accum, current) => accum.concat(Object.values(current).reduce((accum, current) => accum.concat(Object.values(current)), [])), []).length;\n};\n\nconst cart = (state = initialState, action) => {\n  switch (action.type) {\n    case 'ADD_DISH_CART':\n      {\n        const newItems = { ...state.items,\n          [action.payload.id]: !state.items[action.payload.id] ? placeNewDish(action.payload) : placeNewCategoryDish(state, action.payload)\n        };\n        return { ...state,\n          items: newItems,\n          totalPrice: calculateTotalPrice(newItems),\n          totalCount: calculateTotalCount(newItems)\n        };\n      }\n\n    case 'CLEAR_CART':\n      return { ...state,\n        items: {},\n        totalPrice: 0,\n        totalCount: 0\n      };\n\n    case 'REMOVE_CART_ITEM':\n      {\n        const newItems = { ...state.items\n        };\n        delete newItems[Math.trunc(action.payload)][action.payload];\n        return { ...state,\n          items: newItems,\n          totalPrice: calculateTotalPrice(newItems),\n          totalCount: calculateTotalCount(newItems)\n        };\n      }\n\n    case 'PLUS_CART_ITEM':\n      {\n        const newItems = { ...state.items\n        };\n\n        if (newItems[Math.trunc(action.payload)][action.payload].length < 99) {\n          newItems[Math.trunc(action.payload)][action.payload].push(newItems[Math.trunc(action.payload)][action.payload][0]);\n          return { ...state,\n            items: newItems,\n            totalPrice: calculateTotalPrice(newItems),\n            totalCount: calculateTotalCount(newItems)\n          };\n        }\n      }\n\n    case 'MINUS_CART_ITEM':\n      {\n        const newItems = { ...state.items\n        };\n\n        if (newItems[Math.trunc(action.payload)][action.payload].length > 1) {\n          newItems[Math.trunc(action.payload)][action.payload].splice(0, 1);\n          return { ...state,\n            items: newItems,\n            totalPrice: calculateTotalPrice(newItems),\n            totalCount: calculateTotalCount(newItems)\n          };\n        }\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default cart;","map":{"version":3,"sources":["C:/Users/profr/OneDrive/Desktop/Food-Store/src/redux/reducers/cart.js"],"names":["initialState","items","totalPrice","totalCount","placeNewCategoryDish","state","payload","lengthDishesTypes","Object","keys","id","length","sameTypeIndex","values","findIndex","elem","toggle1","toggle2","categoryId","push","placeNewDish","calculateTotalPrice","reduce","accum","cur","price","calculateTotalCount","newItems","current","concat","cart","action","type","Math","trunc","splice"],"mappings":"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","sourcesContent":["const initialState = {\r\n\titems: {},\r\n\ttotalPrice: 0,\r\n\ttotalCount: 0,\r\n}\r\n\r\nconst placeNewCategoryDish = (state, payload) => {\r\n\tlet lengthDishesTypes = Object.keys(state.items[payload.id]).length\r\n\tlet\tsameTypeIndex = Object.values(state.items[payload.id]).findIndex( elem => {\r\n\t\t\tif(payload.toggle1 && payload.toggle2){\r\n\t\t\t\treturn elem[0].toggle1 === payload.toggle1 && elem[0].toggle2 === payload.toggle2\r\n\t\t\t}else if(payload.toggle1){\r\n\t\t\t\treturn elem[0].toggle1 === payload.toggle1\r\n\t\t\t}\r\n\t\t\treturn true\r\n\t\t})\r\n\r\n\tif(sameTypeIndex !== -1){\r\n\t\tpayload.categoryId = +`${payload.id}.${++sameTypeIndex}`\r\n\t\tstate.items[payload.id][`${payload.id}.${sameTypeIndex}`].push(payload)\r\n\t}else{\r\n\t\tpayload.categoryId = +`${payload.id}.${++lengthDishesTypes}`\r\n\t\tstate.items[payload.id][`${payload.id}.${lengthDishesTypes}`] = [payload]\r\n\t}\r\n\r\n\treturn state.items[payload.id]\r\n}\r\n\r\nconst placeNewDish = (payload) => {\r\n\tpayload.categoryId = +payload.id+0.1 \r\n\treturn {[payload.id+0.1]: [payload]}\r\n}\r\n\r\nconst calculateTotalPrice = (items) => {\r\n\treturn Object.values(items).reduce( (accum, cur) => Object.values(cur).reduce( (accum, cur) => Object.values(cur).reduce( (accum, cur) => cur.price + +accum, 0) + +accum, 0 ) + +accum, 0)\r\n}\r\n\r\nconst calculateTotalCount = (newItems) => {\r\n\treturn Object.values(newItems).reduce( (accum, current) => accum.concat(Object.values(current).reduce( (accum, current) => accum.concat(Object.values(current)), []) ), []).length\r\n}\r\n\r\nconst cart = (state = initialState, action) => {\r\n\tswitch(action.type){\r\n\t\tcase 'ADD_DISH_CART': {\r\n\t\t\tconst newItems = {\r\n\t\t\t\t\t...state.items,\r\n\t\t\t\t\t[action.payload.id]: !state.items[action.payload.id]\r\n\t\t\t\t\t? placeNewDish(action.payload)\r\n\t\t\t\t\t: placeNewCategoryDish(state, action.payload) \r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\titems: newItems,\r\n\t\t\t\ttotalPrice: calculateTotalPrice(newItems),\r\n\t\t\t\ttotalCount: calculateTotalCount(newItems),\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'CLEAR_CART':\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\titems: {},\r\n\t\t\t\ttotalPrice: 0,\r\n\t\t\t\ttotalCount: 0,\r\n\t\t\t}\r\n\t\tcase 'REMOVE_CART_ITEM':{\r\n\t\t\tconst newItems = {\r\n\t\t\t\t...state.items,\r\n\t\t\t}\r\n\t\t\tdelete newItems[Math.trunc(action.payload)][action.payload]\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\titems: newItems,\r\n\t\t\t\ttotalPrice: calculateTotalPrice(newItems),\r\n\t\t\t\ttotalCount: calculateTotalCount(newItems),\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'PLUS_CART_ITEM':{\r\n\t\t\tconst newItems = {\r\n\t\t\t\t...state.items,\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (newItems[Math.trunc(action.payload)][action.payload].length < 99){\r\n\t\t\t\tnewItems[Math.trunc(action.payload)][action.payload].push(newItems[Math.trunc(action.payload)][action.payload][0])\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\titems: newItems,\r\n\t\t\t\t\ttotalPrice: calculateTotalPrice(newItems),\r\n\t\t\t\t\ttotalCount: calculateTotalCount(newItems),\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'MINUS_CART_ITEM':{\r\n\t\t\tconst newItems = {\r\n\t\t\t\t...state.items,\r\n\t\t\t}\r\n\r\n\t\t\tif (newItems[Math.trunc(action.payload)][action.payload].length > 1){\r\n\t\t\t\tnewItems[Math.trunc(action.payload)][action.payload].splice(0, 1)\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\titems: newItems,\r\n\t\t\t\t\ttotalPrice: calculateTotalPrice(newItems),\r\n\t\t\t\t\ttotalCount: calculateTotalCount(newItems),\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\n\r\nexport default cart\r\n"]},"metadata":{},"sourceType":"module"}