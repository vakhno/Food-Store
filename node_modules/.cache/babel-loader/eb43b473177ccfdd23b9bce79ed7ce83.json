{"ast":null,"code":"const initialState = {\n  items: {},\n  totalPrice: 0,\n  totalCount: 0\n};\n\nconst placeNewCategoryDish = (state, payload) => {\n  console.log(state, payload);\n  let lengthDishesTypes = Object.keys(state.items[payload.id]).length;\n  let sameTypeIndex = Object.values(state.items[payload.id]).findIndex(elem => {\n    if (payload.toggle1 && payload.toggle2) {\n      return elem[0].toggle1 === payload.toggle1 && elem[0].toggle2 === payload.toggle2;\n    } else if (payload.toggle1) {\n      return elem[0].toggle1 === payload.toggle1;\n    }\n\n    return false;\n  });\n\n  if (sameTypeIndex !== -1) {\n    payload.categoryId = +`${payload.id}.${++sameTypeIndex}`;\n    state.items[payload.id][`${payload.id}.${sameTypeIndex}`].push(payload);\n  } else {\n    payload.categoryId = +`${payload.id}.${++lengthDishesTypes}`;\n    state.items[payload.id][`${payload.id}.${lengthDishesTypes}`] = [payload];\n  }\n\n  return state.items[payload.id];\n};\n\nconst placeNewDish = payload => {\n  payload.categoryId = +payload.id + 0.1;\n  console.log(payload);\n  return {\n    [payload.id + 0.1]: [payload]\n  };\n};\n\nconst calculateTotalPrice = items => {\n  return Object.values(items).reduce((accum, cur) => Object.values(cur).reduce((accum, cur) => Object.values(cur).reduce((accum, cur) => cur.price + +accum, 0) + +accum, 0) + +accum, 0);\n};\n\nconst calculateTotalCount = newItems => {\n  return Object.values(newItems).reduce((accum, current) => accum.concat(Object.values(current).reduce((accum, current) => accum.concat(Object.values(current)), [])), []).length;\n};\n\nconst cart = (state = initialState, action) => {\n  switch (action.type) {\n    case 'ADD_DISH_CART':\n      {\n        const newItems = { ...state.items,\n          [action.payload.id]: !state.items[action.payload.id] ? placeNewDish(action.payload) : placeNewCategoryDish(state, action.payload)\n        };\n        return { ...state,\n          items: newItems,\n          totalPrice: calculateTotalPrice(newItems),\n          totalCount: calculateTotalCount(newItems)\n        };\n      }\n\n    case 'CLEAR_CART':\n      return { ...state,\n        items: {},\n        totalPrice: 0,\n        totalCount: 0\n      };\n\n    case 'REMOVE_CART_ITEM':\n      {\n        const newItems = { ...state.items\n        };\n        delete newItems[Math.trunc(action.payload)][action.payload];\n        return { ...state,\n          items: newItems,\n          totalPrice: calculateTotalPrice(newItems),\n          totalCount: calculateTotalCount(newItems)\n        };\n      }\n\n    case 'PLUS_CART_ITEM':\n      {\n        const newItems = { ...state.items\n        };\n\n        if (newItems[Math.trunc(action.payload)][action.payload].length < 99) {\n          newItems[Math.trunc(action.payload)][action.payload].push(newItems[Math.trunc(action.payload)][action.payload][0]);\n          return { ...state,\n            items: newItems,\n            totalPrice: calculateTotalPrice(newItems),\n            totalCount: calculateTotalCount(newItems)\n          };\n        }\n      }\n\n    case 'MINUS_CART_ITEM':\n      {\n        const newItems = { ...state.items\n        };\n\n        if (newItems[Math.trunc(action.payload)][action.payload].length > 1) {\n          newItems[Math.trunc(action.payload)][action.payload].splice(0, 1);\n          return { ...state,\n            items: newItems,\n            totalPrice: calculateTotalPrice(newItems),\n            totalCount: calculateTotalCount(newItems)\n          };\n        }\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default cart;","map":{"version":3,"sources":["C:/Users/profr/OneDrive/Desktop/Food-Store/src/redux/reducers/cart.js"],"names":["initialState","items","totalPrice","totalCount","placeNewCategoryDish","state","payload","console","log","lengthDishesTypes","Object","keys","id","length","sameTypeIndex","values","findIndex","elem","toggle1","toggle2","categoryId","push","placeNewDish","calculateTotalPrice","reduce","accum","cur","price","calculateTotalCount","newItems","current","concat","cart","action","type","Math","trunc","splice"],"mappings":"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","sourcesContent":["const initialState = {\r\n\titems: {},\r\n\ttotalPrice: 0,\r\n\ttotalCount: 0,\r\n}\r\n\r\nconst placeNewCategoryDish = (state, payload) => {\r\n\tconsole.log(state, payload)\r\n\tlet lengthDishesTypes = Object.keys(state.items[payload.id]).length\r\n\tlet\tsameTypeIndex = Object.values(state.items[payload.id]).findIndex( elem => {\r\n\t\t\tif(payload.toggle1 && payload.toggle2){\r\n\t\t\t\treturn elem[0].toggle1 === payload.toggle1 && elem[0].toggle2 === payload.toggle2\r\n\t\t\t}else if(payload.toggle1){\r\n\t\t\t\treturn elem[0].toggle1 === payload.toggle1\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t})\r\n\r\n\tif(sameTypeIndex !== -1){\r\n\t\tpayload.categoryId = +`${payload.id}.${++sameTypeIndex}`\r\n\t\tstate.items[payload.id][`${payload.id}.${sameTypeIndex}`].push(payload)\r\n\t}else{\r\n\t\tpayload.categoryId = +`${payload.id}.${++lengthDishesTypes}`\r\n\t\tstate.items[payload.id][`${payload.id}.${lengthDishesTypes}`] = [payload]\r\n\t}\r\n\r\n\treturn state.items[payload.id]\r\n}\r\n\r\nconst placeNewDish = (payload) => {\r\n\tpayload.categoryId = +payload.id+0.1 \r\n\tconsole.log(payload)\r\n\treturn {[payload.id+0.1]: [payload]}\r\n}\r\n\r\nconst calculateTotalPrice = (items) => {\r\n\treturn Object.values(items).reduce( (accum, cur) => Object.values(cur).reduce( (accum, cur) => Object.values(cur).reduce( (accum, cur) => cur.price + +accum, 0) + +accum, 0 ) + +accum, 0)\r\n}\r\n\r\nconst calculateTotalCount = (newItems) => {\r\n\treturn Object.values(newItems).reduce( (accum, current) => accum.concat(Object.values(current).reduce( (accum, current) => accum.concat(Object.values(current)), []) ), []).length\r\n}\r\n\r\nconst cart = (state = initialState, action) => {\r\n\tswitch(action.type){\r\n\t\tcase 'ADD_DISH_CART': {\r\n\t\t\tconst newItems = {\r\n\t\t\t\t\t...state.items,\r\n\t\t\t\t\t[action.payload.id]: !state.items[action.payload.id]\r\n\t\t\t\t\t? placeNewDish(action.payload)\r\n\t\t\t\t\t: placeNewCategoryDish(state, action.payload) \r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\titems: newItems,\r\n\t\t\t\ttotalPrice: calculateTotalPrice(newItems),\r\n\t\t\t\ttotalCount: calculateTotalCount(newItems),\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'CLEAR_CART':\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\titems: {},\r\n\t\t\t\ttotalPrice: 0,\r\n\t\t\t\ttotalCount: 0,\r\n\t\t\t}\r\n\t\tcase 'REMOVE_CART_ITEM':{\r\n\t\t\tconst newItems = {\r\n\t\t\t\t...state.items,\r\n\t\t\t}\r\n\t\t\tdelete newItems[Math.trunc(action.payload)][action.payload]\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\titems: newItems,\r\n\t\t\t\ttotalPrice: calculateTotalPrice(newItems),\r\n\t\t\t\ttotalCount: calculateTotalCount(newItems),\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'PLUS_CART_ITEM':{\r\n\t\t\tconst newItems = {\r\n\t\t\t\t...state.items,\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (newItems[Math.trunc(action.payload)][action.payload].length < 99){\r\n\t\t\t\tnewItems[Math.trunc(action.payload)][action.payload].push(newItems[Math.trunc(action.payload)][action.payload][0])\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\titems: newItems,\r\n\t\t\t\t\ttotalPrice: calculateTotalPrice(newItems),\r\n\t\t\t\t\ttotalCount: calculateTotalCount(newItems),\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcase 'MINUS_CART_ITEM':{\r\n\t\t\tconst newItems = {\r\n\t\t\t\t...state.items,\r\n\t\t\t}\r\n\r\n\t\t\tif (newItems[Math.trunc(action.payload)][action.payload].length > 1){\r\n\t\t\t\tnewItems[Math.trunc(action.payload)][action.payload].splice(0, 1)\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\titems: newItems,\r\n\t\t\t\t\ttotalPrice: calculateTotalPrice(newItems),\r\n\t\t\t\t\ttotalCount: calculateTotalCount(newItems),\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\n\r\nexport default cart\r\n"]},"metadata":{},"sourceType":"module"}