"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),e=require("@reach/portal"),r=require("@reach/rect"),n=require("@reach/utils");function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=i(require("tabbable"));function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var f=n.forwardRefWithAs((function(r,n){return t.createElement(e.Portal,null,t.createElement(a,Object.assign({ref:n},r)))})),a=n.forwardRefWithAs((function(e,i){var f=e.as,a=void 0===f?"div":f,l=e.targetRef,d=e.position,p=void 0===d?s:d,v=e.unstable_observableRefs,h=void 0===v?[]:v,g=function(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)e.indexOf(r=o[n])>=0||(i[r]=t[r]);return i}(e,["as","targetRef","position","unstable_observableRefs"]),w=t.useRef(null),b=r.useRect(w,{observe:!g.hidden}),y=r.useRect(l,{observe:!g.hidden}),x=n.useForkedRef(w,i);return function(e,r){var i=n.getOwnerDocument(e.current);function u(t){"Tab"===t.key&&r.current&&0===o.default(r.current).length||("Tab"===t.key&&t.shiftKey?function(t){if(t.shiftKey){var e=f();return t.target===e}}(t)?function(t){var e=r.current&&o.default(r.current),n=e&&e[e.length-1];n&&(t.preventDefault(),n.focus())}(t):function(t){var e=r.current&&o.default(r.current);return!!e&&0!==e.length&&t.target===e[0]}(t)?function(t){var r;t.preventDefault(),null===(r=e.current)||void 0===r||r.focus()}(t):function(t){return t.target===o.default(i)[0]}(t)&&c():"Tab"===t.key&&(e.current&&e.current===i.activeElement?function(t){var e=r.current&&o.default(r.current);e&&e[0]&&(t.preventDefault(),e[0].focus())}(t):function(){if(r.current&&r.current.contains(i.activeElement||null)){var t=r.current&&o.default(r.current);return Boolean(t&&t[t.length-1]===i.activeElement)}return!1}()?function(t){var e=f();e&&(t.preventDefault(),e.focus())}(t):function(t){var e=r.current?o.default(i).filter((function(t){return!r.current.contains(t)})):null;return!!e&&t.target===e[e.length-1]}(t)&&c()))}function f(){var t=o.default(i),n=t&&e.current?t.indexOf(e.current):-1,u=t&&t[n+1];return(!r.current||!r.current.contains(u||null))&&u}t.useEffect((function(){return i.addEventListener("keydown",u),function(){i.removeEventListener("keydown",u)}}),[]);var a=[];function c(){var t=r.current&&o.default(r.current);t&&(t.forEach((function(t){a.push([t,t.tabIndex]),t.tabIndex=-1})),i.addEventListener("focusin",l))}function l(){i.removeEventListener("focusin",l),a.forEach((function(t){t[0].tabIndex=t[1]}))}}(l,w),t.createElement(a,Object.assign({"data-reach-popover":"",ref:x},g,{style:u({position:"absolute"},c.apply(void 0,[p,y,b].concat(h)),g.style)}))}));function c(t,e,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return r?t.apply(void 0,[e,r].concat(i.map((function(t){return t.current})))):{visibility:"hidden"}}function l(t,e){return{top:d(t,e).directionUp?t.top-e.height+window.pageYOffset+"px":t.top+t.height+window.pageYOffset+"px"}}var s=function(t,e){return t&&e?u({left:d(t,e).directionRight?t.right-e.width+window.pageXOffset+"px":t.left+window.pageXOffset+"px"},l(t,e)):{}};function d(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i={top:t.top-e.height<0,right:window.innerWidth<t.left+e.width-r,bottom:window.innerHeight<t.bottom+e.height-n,left:t.left+t.width-e.width<0};return{directionRight:i.right&&!i.left,directionLeft:i.left&&!i.right,directionUp:i.bottom&&!i.top,directionDown:i.top&&!i.bottom}}exports.Popover=f,exports.default=f,exports.getCollisions=d,exports.positionDefault=s,exports.positionMatchWidth=function(t,e){return t&&e?u({width:t.width,left:t.left},l(t,e)):{}},exports.positionRight=function(t,e){return t&&e?u({left:d(t,e).directionLeft?t.left+window.pageXOffset+"px":t.right-e.width+window.pageXOffset+"px"},l(t,e)):{}};
//# sourceMappingURL=popover.cjs.production.min.js.map
